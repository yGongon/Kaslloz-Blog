{
  "rules": {
    "posts": {
      ".read": true,
      "$postId": {
        // Permite a escrita se o usuário for admin, OU se o usuário estiver autenticado e 
        // estiver apenas alterando os votos (garantindo que os campos de conteúdo sensível não sejam modificados).
        ".write": "auth != null && ( (auth.token.email === 'wevelleytwich@gmail.com' || auth.token.email === 'emanuelcarlos534@gmail.com') || (newData.child('title').val() === data.child('title').val() && newData.child('content').val() === data.child('content').val() && newData.child('imageUrl').val() === data.child('imageUrl').val() && newData.child('category').val() === data.child('category').val()) )",
        ".validate": "newData.hasChildren(['title', 'content', 'category', 'imageUrl', 'createdAt'])"
      }
    },
    "pages": {
      ".read": true,
      ".write": "auth != null && (auth.token.email === 'wevelleytwich@gmail.com' || auth.token.email === 'emanuelcarlos534@gmail.com')",
      "$pageId": {
        ".validate": "newData.hasChildren(['title', 'content', 'slug', 'createdAt'])"
      }
    },
    "comments": {
      ".read": true,
      "$commentId": {
        // Permite a escrita se: o usuário estiver autenticado E (for um novo comentário OU ele for o dono OU for um admin)
        ".write": "auth != null && (!data.exists() || data.child('userId').val() === auth.uid || (auth.token.email === 'wevelleytwich@gmail.com' || auth.token.email === 'emanuelcarlos534@gmail.com'))",
        // Ao criar um novo comentário, valida a integridade dos dados
        ".validate": "newData.hasChildren(['postId', 'userId', 'name', 'comment', 'createdAt']) && newData.child('userId').val() === auth.uid"
      }
    },
    "user_votes": {
      ".read": true, // A leitura é pública, mas a lógica do cliente busca apenas os votos do usuário atual
      "$uid": {
        // Um usuário só pode escrever em seus próprios dados de voto
        ".write": "auth != null && $uid === auth.uid"
      }
    },
    "site_config": {
        ".read": true,
        ".write": "auth != null && (auth.token.email === 'wevelleytwich@gmail.com' || auth.token.email === 'emanuelcarlos534@gmail.com')"
    }
  }
}
